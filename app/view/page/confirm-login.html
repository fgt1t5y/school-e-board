<div class="bg-white p-3 shadow-sm gg-form">
  <h4 class="text-center">请输入账号的密码</h4>
  <form id="start-login">
    <div class="form-group">
      <label for="email-input">电子邮箱地址</label>
      <input type="email" name="email" class="form-control d-none" id="email-input" value="{{email}}" required>
      <div class="h5">{{email}}</div>
    </div>
    <div class="form-group">
      <label class="required" for="password-input">密码</label>
      <input type="password" name="password" class="form-control" id="password-input" autocomplete="current-password"
        autofocus required>
    </div>
    <div id="err" class="text-danger"></div>
    <a href="/auth" class="btn btn-outline-primary">返回</a>
    <button type="submit" class="btn btn-primary">提交</button>
  </form>
</div>

<script>
  $('#start-login').on('submit', function (event) {
    event.preventDefault();
    $.getJSON('/api/login',
      {
        email: $('#email-input').val(),
        password: $('#password-input').val(),
      }, function (data) {
        console.log(data);
        if (data.code > 0) {
          $('#err').text(data.message);
        } else {
          localStorage.setItem('nickname', data.nickname);
          localStorage.setItem('avatar_url', data.avatar);
          location.href = '/';
        }
      })
  })
</script>